<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" dir="ltr" lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Files Download</title>
    <script language="javascript">
        var arr = new Array();
        arr[0] = new Array("-select-");
        arr[1] = new Array("-select-","Pages","Paragraphs","Sentences","Words","Characters","Sections","Fields","Fields_IncludePicture","Fields_Sequence","Fields_Embed","Fields_Formula","Fields_TOCEntry","Fields_DocInfo","Fields_UserInfo","Endnotes","Footnotes","FormFields",
                "Bookmarks","Headers","Footers","Comments","CustomXmlParts","Hyperlinks","Lists","Shapes","Shapes_Picture","Shapes_LinkedPicture","Shapes_AutoShape","Shapes_Line","Shapes_TextBox","Shapes_Group","Shapes_Callout","Shapes_Media","Shapes_Canvas",
                "Shapes_Diagram","Shapes_EmbeddedOLEObject","Shapes_ShapeTypeMixed","Shapes_TextEffect","Shapes_SmartArt","Shapes_Table","InlineShapes","InlineShapes_Picture","InlineShapes_LinkedPicture","InlineShapes_EmbeddedOLEObject","InlineShapes_Chart",
                "InlineShapes_HorizontalLine","InlineShapes_OLEControlObject","InlineShapes_SmartArt","InlineShapes_ShapeDiagram","InlineShapes_PictureBullet","Styles","Tables","TOC","Indexes");
        arr[3] = new Array("-select-","Cell_Formatting_Date_Format","Cell_Formatting_Number_Format","Cell_Formatting_Currency_Format","Cell_Formatting_Percentage_Format",	"Cell_Formatting_Text_Horizontal_Left_Align","Cell_Formatting_Text_Horizontal_Right_Align","Cell_Formatting_Text_Horizontal_Centre_Align",
                "Cell_Formatting_Text_Vertical_Top_Align","Cell_Formatting_Text_Vertical_Bottom_Align","Cell_Formatting_Text_Vertical_Centre_Align","Cell_Formatting_Fill_Pattern_Style","Cell_Formatting_Fill_Background_Colour","Charts","Symbols","Pivot_table",
                "Filters","Comments","Formula","Functions","Styles","Sorting","Cell_merge_unmerge","Freeze_panes","Worksheets","Embedded_Objects","Smart ART","Images_Png_Gif","Images_EMF_WMF","Protected_Sheet","Shapes","Table",
                "Hyperlink","HasVBScripts","Forms_Fields","ActiveX_Controls","Conditional_Formatting","Wrap_Text","Hidden_sheet","Merge_Sheet","Page_break",
                "Protected_cell","Cell_Borders");
        arr[2] = new Array("-select-","Pages","Paragraphs","Sentences","Words","Characters","Sections","Fields","Fields_IncludePicture","Fields_Sequence","Fields_Embed","Fields_Formula","Fields_TOCEntry","Fields_DocInfo","Fields_UserInfo","Endnotes","Footnotes","FormFields",
                "Bookmarks","Headers","Footers","Comments","CustomXmlParts","Hyperlinks","Lists","Shapes","Shapes_Picture","Shapes_LinkedPicture","Shapes_AutoShape","Shapes_Line","Shapes_TextBox","Shapes_Group","Shapes_Callout","Shapes_Media","Shapes_Canvas",
                "Shapes_Diagram","Shapes_EmbeddedOLEObject","Shapes_ShapeTypeMixed","Shapes_TextEffect","Shapes_SmartArt","Shapes_Table","InlineShapes","InlineShapes_Picture","InlineShapes_LinkedPicture","InlineShapes_EmbeddedOLEObject","InlineShapes_Chart",
                "InlineShapes_HorizontalLine","InlineShapes_OLEControlObject","InlineShapes_SmartArt","InlineShapes_ShapeDiagram","InlineShapes_PictureBullet","Styles","Tables","TOC","Indexes");
        arr[4] = new Array("-select-","Cell_Formatting_Date_Format","Cell_Formatting_Number_Format","Cell_Formatting_Currency_Format","Cell_Formatting_Percentage_Format",	"Cell_Formatting_Text_Horizontal_Left_Align","Cell_Formatting_Text_Horizontal_Right_Align","Cell_Formatting_Text_Horizontal_Centre_Align",
                "Cell_Formatting_Text_Vertical_Top_Align","Cell_Formatting_Text_Vertical_Bottom_Align","Cell_Formatting_Text_Vertical_Centre_Align","Cell_Formatting_Fill_Pattern_Style","Cell_Formatting_Fill_Background_Colour","Charts","Symbols","Pivot_table",
                "Filters","Comments","Formula","Functions","Styles","Sorting","Cell_merge_unmerge","Freeze_panes","Worksheets","Embedded_Objects","Smart_ART","Images_Png_Gif","Images_EMF_WMF","Protected_Sheet","Shapes","Table",
                "Hyperlink","HasVBScripts","Forms_Fields","ActiveX_Controls","Conditional_Formatting","Wrap_Text","Hidden_sheet","Merge_Sheet","Page_break",
                "Protected_cell","Cell_Borders");

        arr[5] = new Array("-select-","Animations","Comments","Embedded_Objects","Embedded_Objects_Charts","Fonts_Font_Effects","Headers_Footers","Hyperlinks","Images_EMF_WMF","Images_PNG_GIF_JPG","Shapes","Shapes_3D_Effects","Shapes_Fills","Shapes_Freeform","Shapes_Other_Effects",
                "Slide_Backgrounds","SmartArt","Speaker_Notes","Tables","Text_Box","Themes","Transitions","Lists_Numeric","Fonts","Lists_Character","Lists_Picture","Group_shapes","Hidden_Slides");
        arr[6] = new Array("-select-","Animations","Comments","Embedded_Objects","Embedded_Objects_Charts","Fonts_Font_Effects","Headers_Footers","Hyperlinks","Images_EMF_WMF","Images_PNG_GIF_JPG","Shapes","Shapes_3D_Effects","Shapes_Fills","Shapes_Freeform","Shapes_Other_Effects",
                "Slide_Backgrounds","SmartArt","Speaker_Notes","Tables","Text_Box","Themes","Transitions","Lists_Numeric","Fonts","Lists_Character","Lists_Picture","Group_shapes","Hidden_Slides");
        function change(combo1)
        {
            var comboValue=combo1.value;
            document.forms["ajax"].elements["combo2"].options.length=0;
            for (var i=0;i<arr[comboValue].length;i++)
            {
                var option = document.createElement("option");
                option.innerHTML = arr[comboValue][i];
                document.forms["ajax"].elements["combo2"].appendChild(option);
            }
        }
    </script>
    <script src="ajax.js" type="text/javascript"></script>
    <script language="JavaScript">
        var  filetype;
        var SelectedFeature ;
        var FileCount ;
        var checkrandom;
        var flag;
        var datetime;
        function Write(url, content)	// url is the script and data is a string of parameters
        {
            if(content!="check")
            {
                var sbmt = document.getElementById("btnsbt");
                var xhr = createXHR();
                xhr.onreadystatechange=function()
                {
                    if (xhr.readyState==4 && xhr.status==200)
                    {
                        sbmt.disabled = false;
                        var storing = document.getElementById("storage");
                        storing.innerHTML = "<p>Click here to download Files<b><a href='#' id='getdownload' onClick='DownloadFile()'>"+SelectedFeature+"_"+datetime+"</a></b>.";
                        document.getElementById("img").innerHTML="";
                        document.getElementById("subtn").innerHTML="";
                        document.getElementById("image").src = "";

                        flag="false";
                    }
                    else
                    {
                        if(flag=="true")
                        {
                            sbmt.disabled = true;
                            document.getElementById("img").innerHTML="Processing The Files...";
                            document.getElementById("image").src = "C:\\wamp\\www\\Final\\1.gif";
                        }
                    }
                }
                // alert(url+content);
                xhr.open("GET", url+content, true);
                xhr.send();
            }
            else
            {

                var sbmt = document.getElementById("btnsbt");
                var xhr = createXHR();
                xhr.onreadystatechange=function()
                {
                    if (xhr.readyState==4 && xhr.status==200)
                    {
                        sbmt.disabled = false;
                        var storing = document.getElementById("storage");
                        storing.innerHTML = "<p>Click here to download Files<b><a href='#' id='getdownload' onClick='DownloadFile()'>"+SelectedFeature+"_"+datetime+"</a></b>.";
                        document.getElementById("img").innerHTML="";
                        document.getElementById("subtn").innerHTML="";
                        document.getElementById("image").src = "";

                        flag="false";
                    }
                    else
                    {
                        if(flag=="true")
                        {
                            sbmt.disabled = true;
                            document.getElementById("img").innerHTML="Processing The Files...";
                            document.getElementById("image").src = "C:\\wamp\\www\\Final\\1.gif";

                        }
                    }
                }
                // alert(url+content);
                xhr.open("GET", url+content, true);
                xhr.send();
            }
        }
        function DownloadFile()
        {

            var hrefpath="Final/Zip/" + SelectedFeature+"_"+datetime+".zip";
            Write(hrefpath,"check")
            getdownload.href =hrefpath;
            var filepath= SelectedFeature+"_"+datetime+".zip";
            getdownload.download =filepath;

        }
        function isNumberKey(evt)
        {
            var charCode = (evt.which) ? evt.which : event.keyCode;
            if (charCode != 46 && charCode > 31
                    && (charCode < 48 || charCode > 57) )
                return false;

            return true;
        }
        function submitForm()
        {
            getFile();
            var currentdate = new Date();
            datetime = "" + currentdate.getDate() + ""+ (currentdate.getMonth()+1)+ ""+ currentdate.getFullYear() + ""+ currentdate.getHours() +""+ currentdate.getMinutes() + "" + currentdate.getSeconds();
           // alert(datetime);
            flag="true";
            var queryString="";
            filetype = document.getElementById('comb1').value;
            SelectedFeature = document.getElementById('comb2').value;
            FileCount = document.getElementById('filecnt').value;
            checkrandom = document.getElementsByName('random');

            //Validation For All Tools
            if (filetype=="0")
            {
                alert("Please Select FileType");
                return false;
            }
            if (SelectedFeature=="-select-")
            {
                alert("Please Select Feature");
                return false;
            }
            if (FileCount>1000)
            {
                alert("File count should be less than 1000...");
                return false;
            }
            if (FileCount<=0)
            {
                alert("File Count should not be zero and Blank... ");
                return false;
            }

            location.reload();
            queryString = "runFET?id1=1&c1="+filetype+"&c2="+SelectedFeature+"&c3="+FileCount+"&c4=default"+"&c5="+datetime;
            //location.reload();
             alert("Wait.....Downloading Test data...");
            location.href='jenkins1';
            location.href=queryString;




//	Write("callperl.php", queryString);
        }
    </script>
</head>

<p id="demo"></p>


<p>
<p>
<p>
<hr>
<div id="img" align='center'>
    <p id="pid" align="center"></p>
    <img id="image" align="center" src="">
</div>
<FORM name="ajax" method="POST" action="" enctype="multipart/form-data" id="f1">
<input type='hidden' name='csrfmiddlewaretoken' value='randomchars' />
    <table border="1" style="width:25%;" align="center" >


        <th style="width:70%;">
        <td> <b>Feature Extraction Tool</b>    </td></th>

        <tr>
            <th  style="width:20%;">Criteria </th>
            <th  style="width:20%;">Values</th>
        </tr>
        <tr>

            <th  style="width:20%;">File Type:</th>
            <td><select name="combo1" id="comb1" onchange="change(this);">
                <option value="0">-Select-</option>
                <option value="1">doc</option>
                <option value="2">docx</option>
                <option value="3">xls</option>
                <option value="4">xlsx</option>
                <option value="5">ppt</option>
                <option value="6">pptx</option>
            </select>
            </td>
        </tr>
        <tr>
            <th style="width:20%;">Feature:</th>
            <td><select name="combo2" id="comb2"></select>
            </td>
        </tr>


        <tr>
            <th  style="width:20%;">File Count:</th>
            <td><input type="text" id="filecnt" name="fileCount" onkeypress="return isNumberKey(event)"> </td>
        </tr>
    <tr>

        <th style="width:70%;">  </th>
        <td> <b>C2C Automation Tool</b>    </td>

    </tr>



    <h1 align="center"> C2C Automation Run</h1>
        <tr>
<th  style="width:20%;">Email Address</th>
            <td>
        <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email"></td>
    <div class="form-group">

    </div>
</th>
</tr>

<tr>
<th  style="width:20%;">Upload Base-line Build</th>
    <div class="control-group">

            <td>
             {{ form.docfile}}

    </div>
</th>
</tr>


    <tr>
<th  style="width:20%;">Upload Compare Build</th>
    <div class="control-group">

            <td>
            {{ form.docfile}}
        {{ form.docfile.label}}

    </div>
</th>
</tr>




<th  style="width:50%;" ></th>
        <td> <b>Run C2C</b></td>
 <div class="btn-group">

        <td><input type="submit" class="btn" value="CRX Upload" onClick="" hidden="hidden"  id="uploadcrx" ></td>
        </div>
            </th>

 <script language="JavaScript">

     function getFile(){
        document.getElementById("uploadcrx").click();
         alert("File is getting Uploaded....")
    }


   var myVar=setInterval(function(){myTimer()},1000);

    function myTimer()
    {
    var d=new Date();
    var t=d.toLocaleTimeString();
    document.getElementById("demo").innerHTML=t;
    }


</script>



<!--displaying views.py data-->
    {% if cmd %}
        {{ cmd }}

    {% endif %}
    {% if command %}
        {{ command}}
        <p> Running python script baby....wait...</p>
    {% endif %}

{% if documents %}
			<ul>
			{% for document in documents %}
			  <!--{{ document.docfile}}-->

				<!--<li><a href="{{ document.docfile.url}}">{{ document.docfile.name }}</a></li>-->

{% endfor %}

			</ul>
{% else %}
	<p>No documents.</p>
{% endif %}

	{% csrf_token %}
			<p>{{ form.non_field_errors }}</p>
			<p>{{ form.docfile.label_tag }} {{ form.docfile.help_text }}</p>
			<p>
				{{ form.docfile.errors }}

				{{ form.docfile.help_text}}
                {{ form.docfile.max_length }}

			</p>

        <p>
    <tr>

     <tr>
            <th colspan="2"><INPUT type="button" name="subtn" id="btnsbt" value="RUN C2C"   onclick="submitForm()" style=" background-color:limegreen" > </th>

        </tr>

     </p>
</table>

    <br>
    <p>
    <p>
<p>
    <hr>
<div id="img" align='center'>
    <p id="pid" align="center"></p>
    <img id="image" align="center" src="">
</div>
</fieldset>

</FORM>

</body>
</html>